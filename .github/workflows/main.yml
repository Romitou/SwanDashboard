name: PHP CI
on: [push, pull_request]
jobs:
  symfony-webpack:
    runs-on: ubuntu-latest
    steps:

    - name: ⬇️ Checkout
      uses: actions/checkout@v2

    - name: 📦 Cache Node modules
      uses: actions/cache@v2
      id: cache
      env:
        cache-name: cache-node-modules
      with:
        path: ./node_modules/
        key: ${{ runner.os }}-build-${{ hashFiles('**/yarn.lock') }}
        restore-keys: |
          ${{ runner.os }}-build-

    - name: ➕ Install Node modules
      if: steps.cache.outputs.cache-hit != 'true'
      run: yarn

    - name: 👷 Run production build
      run: yarn build

  composer-validate:
    runs-on: ubuntu-latest
    steps:

    - name: ⬇️ Checkout
      uses: actions/checkout@v2

    - name: ✅ Composer validate
      run: composer validate
